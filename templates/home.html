<!DOCTYPE html>
<html lang="en" xmlns:fb="http://ogp.me/ns/fb#">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Broken.tv</title>

    {% if css_location %}
      <link rel="stylesheet" type="text/css" href="{{ css_location }}">
    {% else %}
      <link rel="stylesheet/less" type="text/css" href="/less/main.less">
      <script src="/static/js/less-1.3.1.min.js" type="text/javascript"></script>
    {% endif %}

		<script src="/_ah/channel/jsapi" type="text/javascript" ></script>
		<script src="/static/js/raphael-min.js" type="text/javascript"></script>
		<script>
			// Re-namespace to avoid closure conflict.
			var appengine = goog.appengine; 
		</script>
		<script src="{{ js_location }}"></script>
		<script><!--
			var tag = document.createElement('script');
			tag.src = "http://www.youtube.com/player_api";
			var firstScriptTag = document.getElementsByTagName('script')[0];
			firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
		</script>
  </head>
  <body>
    <div id="login">
      <div class="logo">
        <div id="oken"></div>
        <div id="fb-login" class="fb-login" style="display: none">
          Login with Facebook
        </div>
      </div>
      <div class="broken-media-production"></div>
    </div>
    <div id="overlay" style="display: none"></div>
    <div id="fb-root"></div>
		 
	  <script><!--
		  var ytLoaded = false;
		  var fbLoaded = false;
		  function onYouTubePlayerAPIReady() {
		    ytLoaded = true;
		    fbLoaded && brkn.Main.auth();
		  }
	    window.fbAsyncInit = function() {
	      FB.init({appId: '{{ facebook_app_id }}', status: true, cookie: true,
	               xfbml: true, oauth: true});
	    };
	    window.fbAsyncInit = function() {
	      FB.init({
	        appId      : '{{ facebook_app_id }}', // App ID
	        channelUrl : '//localhost:8011/static/channel.html', // Channel File
	        status     : true, // check login status
	        cookie     : true, // enable cookies to allow the server to access the session
	        xfbml      : true  // parse XFBML
	      });
	      fbLoaded = true;
	      ytLoaded && brkn.Main.auth();
	      
	    };
	 		// Load the SDK Asynchronously
	    (function(d){
	       var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
	       if (d.getElementById(id)) {return;}
	       js = d.createElement('script'); js.id = id; js.async = true;
	       js.src = "//connect.facebook.net/en_US/all.js";
	       ref.parentNode.insertBefore(js, ref);
	     }(document));

	    // Google Analytics
	    var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38058655-1']);
      _gaq.push(['_trackPageview']);
    
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
